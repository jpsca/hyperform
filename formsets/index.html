



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A not-terrible Python form library.">
      
      
        <link rel="canonical" href="https://github.com/jpscaletti/proper-form/formsets/">
      
      
        <meta name="author" content="Juan-Pablo Scaletti">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Form sets - Proper Form</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../css/colorful.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-XXXXXXXX-X", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="pink">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#form-sets" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://github.com/jpscaletti/proper-form" title="Proper Form" aria-label="Proper Form" class="md-header-nav__button md-logo">
          
            <i class="md-icon">cloud_done</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Proper Form
            </span>
            <span class="md-header-nav__topic">
              
                Form sets
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/jpscaletti/proper-form" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jpscaletti/proper-form
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://github.com/jpscaletti/proper-form" title="Proper Form" class="md-nav__button md-logo">
      
        <i class="md-icon">cloud_done</i>
      
    </a>
    Proper Form
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/jpscaletti/proper-form" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jpscaletti/proper-form
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../crash/" title="Crash course" class="md-nav__link">
      Crash course
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../forms/" title="Forms" class="md-nav__link">
      Forms
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fields/" title="Fields" class="md-nav__link">
      Fields
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rendering/" title="Rendering" class="md-nav__link">
      Rendering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../validators/" title="Validators" class="md-nav__link">
      Validators
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Form sets
      </label>
    
    <a href="./" title="Form sets" class="md-nav__link md-nav__link--active">
      Form sets
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-object-data-with-a-formset" class="md-nav__link">
    Using object data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-input-data-with-a-formset" class="md-nav__link">
    Using input data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-existing-forms" class="md-nav__link">
    Deleting existing forms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formclass" class="md-nav__link">
    FormClass
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backref-none" class="md-nav__link">
    backref (None)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#without-backref" class="md-nav__link">
    Without backref
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-backref" class="md-nav__link">
    With backref
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra-1" class="md-nav__link">
    extra (1)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_num-none" class="md-nav__link">
    min_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_num-none" class="md-nav__link">
    max_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_delete-true" class="md-nav__link">
    can_delete (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_create-true" class="md-nav__link">
    can_create (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error_messages-none" class="md-nav__link">
    error_messages (None)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-new-forms-with-javascript" class="md-nav__link">
    Adding new forms with JavaScript
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../orm/" title="ORM integration" class="md-nav__link">
      ORM integration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-object-data-with-a-formset" class="md-nav__link">
    Using object data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-input-data-with-a-formset" class="md-nav__link">
    Using input data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-existing-forms" class="md-nav__link">
    Deleting existing forms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formclass" class="md-nav__link">
    FormClass
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backref-none" class="md-nav__link">
    backref (None)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#without-backref" class="md-nav__link">
    Without backref
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-backref" class="md-nav__link">
    With backref
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra-1" class="md-nav__link">
    extra (1)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_num-none" class="md-nav__link">
    min_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_num-none" class="md-nav__link">
    max_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_delete-true" class="md-nav__link">
    can_delete (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_create-true" class="md-nav__link">
    can_create (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error_messages-none" class="md-nav__link">
    error_messages (None)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-new-forms-with-javascript" class="md-nav__link">
    Adding new forms with JavaScript
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="form-sets">Form sets<a class="headerlink" href="#form-sets" title="Permanent link">#</a></h1>
<p>Form sets are the secret weapon ofthis library. Imagine you have models like this:</p>
<p style="text-align:center"><img alt="Person has many websites" src="../img/form-set-model.png" width="400" /></p>
<p>With most form libraries, you would need to have a page for creating/updating the URLs and, only then, you would be able to create/update the person data. What a waste of time!</p>
<p>With a form set, you can create/update the person <em>and</em> its URLs at the same time, in a single form.</p>
<p><a href="../img/form-set-form.png"><img alt="Form set form" src="../img/form-set-form.png" /></a></p>
<p>To do so, you need to create two forms, one for the person data, and other for a website, and connect them like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">WebPageForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">()</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>
    <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">)</span>
</code></pre></div>

<p>a <code>FormSet</code> is a special kind of <code>Field</code> that represents a list of forms, to create or edit several items, in the same page, at once.</p>
<p>Now that you have a formset you can iterate over the forms in it and display them as you would with a regular form.</p>
<p>In the console:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">webs</span><span class="p">)</span>
<span class="p">[</span><span class="n">WebPageForm</span><span class="p">]</span>
</code></pre></div>

<p>or in a template like this one</p>
<p><div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Name <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>(required)<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
  <span class="cp">{{</span> <span class="nv">form.name.as_input</span><span class="o">(</span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">)</span> <span class="cp">}}</span>
  <span class="cp">{{</span> <span class="nv">form.name.render_error</span><span class="o">()</span> <span class="cp">}}</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">f</span> <span class="k">in</span> <span class="nv">form.webs</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6&quot;</span><span class="p">&gt;</span>
    <span class="cp">{{</span> <span class="nv">f.url.as_input</span><span class="o">(</span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">,</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">&quot;http://&quot;</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">f.url.render_error</span><span class="o">()</span> <span class="cp">}}</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-5&quot;</span><span class="p">&gt;</span>
    <span class="cp">{{</span> <span class="nv">f.title.as_input</span><span class="o">(</span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">,</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">&quot;Title (optional)&quot;</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">f.title.render_error</span><span class="o">()</span> <span class="cp">}}</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="cp">{%</span>- <span class="k">endfor</span> <span class="cp">%}</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
&hellip; that renders into</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Name <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>(required)<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;name&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;url&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;http://&quot;</span>
      <span class="na">type</span><span class="o">=</span><span class="s">&quot;url&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-5&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Title (optional)&quot;</span>
      <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>As you can see it only displayed one, empty, <code>WebPageForm</code>. It creates one for each item in the input or object data (and we have none), plus the value of the <code>extra</code> attribute, that is one by default. You can set it to 0 or to a larger number to change that.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">PersonForm</span><span class="p">()</span><span class="o">.</span><span class="n">webs</span><span class="p">)</span>
<span class="p">[</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">]</span>
</code></pre></div>

<p>Iterating over the formset will render the forms in the order they were created. FormSets can also be indexed into, which returns the corresponding form.</p>
<h2 id="using-object-data-with-a-formset">Using object data with a formset<a class="headerlink" href="#using-object-data-with-a-formset" title="Permanent link">#</a></h2>
<p>As shown above you can define the number of extra forms. What this means is that you are telling the formset how many additional forms to show in addition to the number of forms it generates from the object data. Let’s take a look at an example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">WebPageForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">title</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="p">{</span>
<span class="o">...</span>     <span class="s2">&quot;webs&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="o">...</span>         <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/1&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Example 1&quot;</span><span class="p">},</span>
<span class="o">...</span>         <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/2&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Example 2&quot;</span><span class="p">},</span>
<span class="o">...</span>     <span class="p">]</span>
<span class="o">...</span> <span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">webs</span><span class="p">)</span>
<span class="p">[</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">form</span><span class="o">.</span><span class="n">webs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">name</span>
<span class="s1">&#39;webs--2--url&#39;</span>
</code></pre></div>

<p>There are now a total of three forms showing above. Two for the object data that was passed in and one extra form. Also note the format of the HTML names of the fields in the forms of the formset. It follows this format:</p>
<p style="text-align:center;font-family:monospace;font-size:larger;font-weight:bold"><em>form_prefix</em>. <em>formset_name</em> -- <strong>OBJECT_ID</strong> -- <em>field_name</em></p>
<p>Notice how this imply each object <strong>must</strong> have a distinct ID, even if the data comes as dictionaries.</p>
<p>Why Proper Form doesn&rsquo;t use a a simple counter, like the rest of form libraries? The answer it&rsquo;s to protect you from <em>race conditions</em>. You want to update a specific object, not just &ldquo;the second object from the list&rdquo;, because there is no guarantee the list hasn&rsquo;t changed while the form was filled by the user.  Using IDs guarantees that you are updating the object you wanted to, even if is not in the same order as before.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>“But&hellip; what if the user manually change the IDs in the names? Would they be able to change the data of any other objects, like the one from another users?!”</em></p>
<p>No, don&rsquo;t worry! Proper Form ignore any ID that isn&rsquo;t in the current list of objects. This feature prevents anyone to access/update data they shouldn&rsquo;t.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example we are passing in a list of dictionaries as the object data, but the most common scenario will be using the result of a query using an ORM. In any case, it makes no difference.</p>
</div>
<h2 id="using-input-data-with-a-formset">Using input data with a formset<a class="headerlink" href="#using-input-data-with-a-formset" title="Permanent link">#</a></h2>
<p>A formset can accept any number of new forms. A &ldquo;new form&rdquo; are those that aren&rsquo;t created for editing an existing object, but added client side. To do so, the names of the fields must follow this pattern:</p>
<p style="text-align:center;font-family:monospace;font-size:larger;font-weight:bold"><em>prefix</em>. <em>formset_name</em> -- _NEWx -- <em>field_name</em></p>
<p>where &ldquo;x&rdquo; is a number shared by all the fields of a form. They doesn&rsquo;t have to be correlative, but they must be different for each form, example:</p>
<div class="highlight"><pre><span></span><code><span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW1</span><span class="o">--</span><span class="nx">url</span>
<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW1</span><span class="o">--</span><span class="nx">title</span>

<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW2</span><span class="o">--</span><span class="nx">url</span>
<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW2</span><span class="o">--</span><span class="nx">title</span>

<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW3</span><span class="o">--</span><span class="nx">url</span>
<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW3</span><span class="o">--</span><span class="nx">title</span>
</code></pre></div>

<p>If you create a formset with <code>can_create=False</code>, all the new forms are ignored.</p>
<h2 id="deleting-existing-forms">Deleting existing forms<a class="headerlink" href="#deleting-existing-forms" title="Permanent link">#</a></h2>
<p>Formsets monitor the presence of a special name to know if it has to delete a form and, more importantly, its related object. Not including the form fields doesn&rsquo;t do anything, to actually delete its object you must send to the form field with a name that follows this pattern:</p>
<p style="text-align:center;font-family:monospace;font-size:larger;font-weight:bold"><em>prefix</em>. <em>formset_name</em> -- <em>OBJECT_ID</em> -- _DELETED</p>
<p>If you create a formset with <code>can_delete=False</code>, this special name is ignored.</p>
<h2 id="arguments">Arguments<a class="headerlink" href="#arguments" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">FormSet</span><span class="p">(</span>
    <span class="n">FormClass</span><span class="p">,</span>
    <span class="n">backref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">extra</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">min_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">can_delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">can_create</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">error_messages</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="formclass">FormClass<a class="headerlink" href="#formclass" title="Permanent link">#</a></h3>
<h3 id="backref-none">backref <small>(<code>None</code>)</small><a class="headerlink" href="#backref-none" title="Permanent link">#</a></h3>
<p>If your forms inside the formset have a <code>_model</code> attribute, they will update/create rows in a database when saving the parent form, as expected.</p>
<p>When that&rsquo;s the case, the <code>backref</code> attribute is something you might need to add.</p>
<h4 id="without-backref">Without backref<a class="headerlink" href="#without-backref" title="Permanent link">#</a></h4>
<p><img alt="Without backref" src="../img/without-backref.png" /></p>
<p><strong>Without</strong> a <code>backref</code> attribute, Proper Form will try to save the child forms first, and them assign the list of them to the parent form. If you are dealing with models instead of dictionaries, your database might not like that.</p>
<p>In the example above, a WebPage model will have a non-nullable <code>person_id</code> field. If we save those forms first, you will not have yet a <code>person</code> to get the ID from, so the save operation is going to fail.</p>
<p>We&rsquo;ll need to create a person first, <em>and then</em> create the child objects using the person as an argument.</p>
<h4 id="with-backref">With backref<a class="headerlink" href="#with-backref" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Possible SQLAlchemy models</span>

<span class="k">class</span> <span class="nc">WebPage</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
  <span class="n">owner_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;owner.id&quot;</span><span class="p">))</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Person&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;webs&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
</code></pre></div>

<p>A <code>backref</code> is how the child models call its parents, in this example, is &ldquo;owner&rdquo;, so we use that as a backref attribute:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">WebPageForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">()</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>
  <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span>
</code></pre></div>

<p>When Proper Form receives a <code>backref</code>, it reverse the order of the form saving. Now first it creates the parent object, and then the child objects using the parent object as an attribute.</p>
<p><img alt="With backref" src="../img/with-backref.png" /></p>
<p>In this way, no database constraints are broken and the saving of the form finish without problems.</p>
<h3 id="extra-1">extra <small>(<code>1</code>)</small><a class="headerlink" href="#extra-1" title="Permanent link">#</a></h3>
<p>Number of extra empty forms added to the list, even if there is no data available.</p>
<h3 id="min_num-none">min_num <small>(<code>None</code>)</small><a class="headerlink" href="#min_num-none" title="Permanent link">#</a></h3>
<p>Validates that the number of sub-forms, existing plus new, is <em>at least</em> this.</p>
<h3 id="max_num-none">max_num <small>(<code>None</code>)</small><a class="headerlink" href="#max_num-none" title="Permanent link">#</a></h3>
<p>Validates that the number of sub-forms, existing plus new, is <em>at most</em> this.</p>
<h3 id="can_delete-true">can_delete <small>(<code>True</code>)</small><a class="headerlink" href="#can_delete-true" title="Permanent link">#</a></h3>
<p>If this option is <code>False</code>, <a href="#deleting-existing-forms">the special name</a> to delete a form is ignored and no objects are deleted.</p>
<h3 id="can_create-true">can_create <small>(<code>True</code>)</small><a class="headerlink" href="#can_create-true" title="Permanent link">#</a></h3>
<p>If this option is <code>False</code>, <a href="#using-input-data-with-a-formset">the data from all new forms</a> is ignored. You can only use the formset to edit the data of pre-existing objects.</p>
<h3 id="error_messages-none">error_messages <small>(<code>None</code>)</small><a class="headerlink" href="#error_messages-none" title="Permanent link">#</a></h3>
<p>The <code>min_num</code>, and <code>max_num</code> validations fail with this predefined error messages:</p>
<div class="highlight"><pre><span></span><code><span class="n">default_error_messages</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;min_num&quot;</span><span class="p">:</span> <span class="s2">&quot;Please submit at least </span><span class="si">{num}</span><span class="s2"> forms.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_num&quot;</span><span class="p">:</span> <span class="s2">&quot;Please submit at most </span><span class="si">{num}</span><span class="s2"> forms.&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>

<p>The <code>error_messages</code> argument allows you to overwrite all or one of these messages by passing a dictionary with your custom error messages for those validations.</p>
<h2 id="adding-new-forms-with-javascript">Adding new forms with JavaScript<a class="headerlink" href="#adding-new-forms-with-javascript" title="Permanent link">#</a></h2>
<p>[ TODO ]</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <footer class="md-footer"><div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid"><a href="../validators/" title="Validators" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">Previous</span>Validators</span>
            </div>
          </a><a href="../orm/" title="ORM integration" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">Next</span>ORM integration</span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a></nav>
    </div><div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">
        <p>
          This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a> License.
        </p>
        <p>
          Powered by <a href="https://www.mkdocs.org">MkDocs</a>.
        </p>
      </div>
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/jpscaletti/proper-form" target="_blank" rel="noopener" title="globe" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/jpscaletti/proper-form" target="_blank" rel="noopener" title="github-alt" class="md-footer-social__link fa fa-github-alt"></a>
    
  </div>
</div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>