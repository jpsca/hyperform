


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A not-terrible Python form library.">
      
      
        <link rel="canonical" href="https://github.com/jpsca/proper-form/formsets/">
      
      
        <meta name="author" content="Juan-Pablo Scaletti">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.3.3">
    
    
      
        <title>Form sets - Proper Form</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.fe0cca5b.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.a46bcfb3.min.css">
      
      
        
        
        <meta name="theme-color" content="#ef5350">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/colorful.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="red" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#form-sets" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://github.com/jpsca/proper-form" title="Proper Form" class="md-header-nav__button md-logo" aria-label="Proper Form">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.35 10.03A7.49 7.49 0 0012 4C9.11 4 6.6 5.64 5.35 8.03A6.004 6.004 0 000 14a6 6 0 006 6h13a5 5 0 005-5c0-2.64-2.05-4.78-4.65-4.97z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Proper Form
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Form sets
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/jpsca/proper-form" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jpsca/proper-form
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://github.com/jpsca/proper-form" title="Proper Form" class="md-nav__button md-logo" aria-label="Proper Form">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.35 10.03A7.49 7.49 0 0012 4C9.11 4 6.6 5.64 5.35 8.03A6.004 6.004 0 000 14a6 6 0 006 6h13a5 5 0 005-5c0-2.64-2.05-4.78-4.65-4.97z"/></svg>

    </a>
    Proper Form
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/jpsca/proper-form" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jpsca/proper-form
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../crash/" title="Crash course" class="md-nav__link">
      Crash course
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../forms/" title="Forms" class="md-nav__link">
      Forms
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fields/" title="Fields" class="md-nav__link">
      Fields
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rendering/" title="Rendering" class="md-nav__link">
      Rendering
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../validators/" title="Validators" class="md-nav__link">
      Validators
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Form sets
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Form sets" class="md-nav__link md-nav__link--active">
      Form sets
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-object-data-with-a-formset" class="md-nav__link">
    Using object data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-input-data-with-a-formset" class="md-nav__link">
    Using input data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-existing-forms" class="md-nav__link">
    Deleting existing forms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav" aria-label="Arguments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formclass" class="md-nav__link">
    FormClass
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backref-none" class="md-nav__link">
    backref (None)
  </a>
  
    <nav class="md-nav" aria-label="backref (None)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#without-backref" class="md-nav__link">
    Without backref
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-backref" class="md-nav__link">
    With backref
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra-1" class="md-nav__link">
    extra (1)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_num-none" class="md-nav__link">
    min_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_num-none" class="md-nav__link">
    max_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_delete-true" class="md-nav__link">
    can_delete (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_create-true" class="md-nav__link">
    can_create (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error_messages-none" class="md-nav__link">
    error_messages (None)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-new-forms-with-javascript" class="md-nav__link">
    Adding new forms with JavaScript
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../orm/" title="ORM integration" class="md-nav__link">
      ORM integration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-object-data-with-a-formset" class="md-nav__link">
    Using object data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-input-data-with-a-formset" class="md-nav__link">
    Using input data with a formset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deleting-existing-forms" class="md-nav__link">
    Deleting existing forms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav" aria-label="Arguments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formclass" class="md-nav__link">
    FormClass
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backref-none" class="md-nav__link">
    backref (None)
  </a>
  
    <nav class="md-nav" aria-label="backref (None)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#without-backref" class="md-nav__link">
    Without backref
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-backref" class="md-nav__link">
    With backref
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extra-1" class="md-nav__link">
    extra (1)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#min_num-none" class="md-nav__link">
    min_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max_num-none" class="md-nav__link">
    max_num (None)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_delete-true" class="md-nav__link">
    can_delete (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can_create-true" class="md-nav__link">
    can_create (True)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error_messages-none" class="md-nav__link">
    error_messages (None)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-new-forms-with-javascript" class="md-nav__link">
    Adding new forms with JavaScript
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="form-sets">Form sets<a class="headerlink" href="#form-sets" title="Permanent link">#</a></h1>
<p>Form sets are the secret weapon ofthis library. Imagine you have models like this:</p>
<p style="text-align:center"><img alt="Person has many websites" src="../img/form-set-model.png" width="400" /></p>
<p>With most form libraries, you would need to have a page for creating/updating the URLs and, only then, you would be able to create/update the person data. What a waste of time!</p>
<p>With a form set, you can create/update the person <em>and</em> its URLs at the same time, in a single form.</p>
<p><a href="../img/form-set-form.png"><img alt="Form set form" src="../img/form-set-form.png" /></a></p>
<p>To do so, you need to create two forms, one for the person data, and other for a website, and connect them like this:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">WebPageForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">()</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>
    <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">)</span>
</code></pre></div>

<p>a <code>FormSet</code> is a special kind of <code>Field</code> that represents a list of forms, to create or edit several items, in the same page, at once.</p>
<p>Now that you have a formset you can iterate over the forms in it and display them as you would with a regular form.</p>
<p>In the console:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">webs</span><span class="p">)</span>
<span class="p">[</span><span class="n">WebPageForm</span><span class="p">]</span>
</code></pre></div>

<p>or in a template like this one</p>
<p><div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Name <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>(required)<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
  <span class="cp">{{</span> <span class="nv">form.name.as_input</span><span class="o">(</span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">)</span> <span class="cp">}}</span>
  <span class="cp">{{</span> <span class="nv">form.name.render_error</span><span class="o">()</span> <span class="cp">}}</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">f</span> <span class="k">in</span> <span class="nv">form.webs</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6&quot;</span><span class="p">&gt;</span>
    <span class="cp">{{</span> <span class="nv">f.url.as_input</span><span class="o">(</span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">,</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">&quot;http://&quot;</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">f.url.render_error</span><span class="o">()</span> <span class="cp">}}</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-5&quot;</span><span class="p">&gt;</span>
    <span class="cp">{{</span> <span class="nv">f.title.as_input</span><span class="o">(</span><span class="nv">class</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">,</span> <span class="nv">placeholder</span><span class="o">=</span><span class="s2">&quot;Title (optional)&quot;</span><span class="o">)</span> <span class="cp">}}</span>
    <span class="cp">{{</span> <span class="nv">f.title.render_error</span><span class="o">()</span> <span class="cp">}}</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="cp">{%</span>- <span class="k">endfor</span> <span class="cp">%}</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>
&hellip; that renders into</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-group&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Name <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>(required)<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;name&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-6&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;url&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;http://&quot;</span>
      <span class="na">type</span><span class="o">=</span><span class="s">&quot;url&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-sm-5&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;title&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Title (optional)&quot;</span>
      <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

<p>As you can see it only displayed one, empty, <code>WebPageForm</code>. It creates one for each item in the input or object data (and we have none), plus the value of the <code>extra</code> attribute, that is one by default. You can set it to 0 or to a larger number to change that.</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">PersonForm</span><span class="p">()</span><span class="o">.</span><span class="n">webs</span><span class="p">)</span>
<span class="p">[</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">]</span>
</code></pre></div>

<p>Iterating over the formset will render the forms in the order they were created. FormSets can also be indexed into, which returns the corresponding form.</p>
<h2 id="using-object-data-with-a-formset">Using object data with a formset<a class="headerlink" href="#using-object-data-with-a-formset" title="Permanent link">#</a></h2>
<p>As shown above you can define the number of extra forms. What this means is that you are telling the formset how many additional forms to show in addition to the number of forms it generates from the object data. Let’s take a look at an example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">WebPageForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">title</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>
<span class="o">...</span>     <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">form</span> <span class="o">=</span> <span class="n">PersonForm</span><span class="p">(</span><span class="nb">object</span><span class="o">=</span><span class="p">{</span>
<span class="o">...</span>     <span class="s2">&quot;webs&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="o">...</span>         <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/1&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Example 1&quot;</span><span class="p">},</span>
<span class="o">...</span>         <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.com/2&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Example 2&quot;</span><span class="p">},</span>
<span class="o">...</span>     <span class="p">]</span>
<span class="o">...</span> <span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">webs</span><span class="p">)</span>
<span class="p">[</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">,</span> <span class="n">WebPageForm</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">form</span><span class="o">.</span><span class="n">webs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">name</span>
<span class="s1">&#39;webs--2--url&#39;</span>
</code></pre></div>

<p>There are now a total of three forms showing above. Two for the object data that was passed in and one extra form. Also note the format of the HTML names of the fields in the forms of the formset. It follows this format:</p>
<p style="text-align:center;font-family:monospace;font-size:larger;font-weight:bold"><em>form_prefix</em>. <em>formset_name</em> -- <strong>OBJECT_ID</strong> -- <em>field_name</em></p>
<p>Notice how this imply each object <strong>must</strong> have a distinct ID, even if the data comes as dictionaries.</p>
<p>Why Proper Form doesn&rsquo;t use a a simple counter, like the rest of form libraries? The answer it&rsquo;s to protect you from <em>race conditions</em>. You want to update a specific object, not just &ldquo;the second object from the list&rdquo;, because there is no guarantee the list hasn&rsquo;t changed while the form was filled by the user.  Using IDs guarantees that you are updating the object you wanted to, even if is not in the same order as before.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>“But&hellip; what if the user manually change the IDs in the names? Would they be able to change the data of any other objects, like the one from another users?!”</em></p>
<p>No, don&rsquo;t worry! Proper Form ignore any ID that isn&rsquo;t in the current list of objects. This feature prevents anyone to access/update data they shouldn&rsquo;t.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the example we are passing in a list of dictionaries as the object data, but the most common scenario will be using the result of a query using an ORM. In any case, it makes no difference.</p>
</div>
<h2 id="using-input-data-with-a-formset">Using input data with a formset<a class="headerlink" href="#using-input-data-with-a-formset" title="Permanent link">#</a></h2>
<p>A formset can accept any number of new forms. A &ldquo;new form&rdquo; are those that aren&rsquo;t created for editing an existing object, but added client side. To do so, the names of the fields must follow this pattern:</p>
<p style="text-align:center;font-family:monospace;font-size:larger;font-weight:bold"><em>prefix</em>. <em>formset_name</em> -- _NEWx -- <em>field_name</em></p>
<p>where &ldquo;x&rdquo; is a number shared by all the fields of a form. They doesn&rsquo;t have to be correlative, but they must be different for each form, example:</p>
<div class="highlight"><pre><span></span><code><span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW1</span><span class="o">--</span><span class="nx">url</span>
<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW1</span><span class="o">--</span><span class="nx">title</span>

<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW2</span><span class="o">--</span><span class="nx">url</span>
<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW2</span><span class="o">--</span><span class="nx">title</span>

<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW3</span><span class="o">--</span><span class="nx">url</span>
<span class="nx">webs</span><span class="o">--</span><span class="nx">_NEW3</span><span class="o">--</span><span class="nx">title</span>
</code></pre></div>

<p>If you create a formset with <code>can_create=False</code>, all the new forms are ignored.</p>
<h2 id="deleting-existing-forms">Deleting existing forms<a class="headerlink" href="#deleting-existing-forms" title="Permanent link">#</a></h2>
<p>Formsets monitor the presence of a special name to know if it has to delete a form and, more importantly, its related object. Not including the form fields doesn&rsquo;t do anything, to actually delete its object you must send to the form field with a name that follows this pattern:</p>
<p style="text-align:center;font-family:monospace;font-size:larger;font-weight:bold"><em>prefix</em>. <em>formset_name</em> -- <em>OBJECT_ID</em> -- _DELETED</p>
<p>If you create a formset with <code>can_delete=False</code>, this special name is ignored.</p>
<h2 id="arguments">Arguments<a class="headerlink" href="#arguments" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">FormSet</span><span class="p">(</span>
    <span class="n">FormClass</span><span class="p">,</span>
    <span class="n">backref</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">extra</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">min_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">max_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">can_delete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">can_create</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">error_messages</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="formclass">FormClass<a class="headerlink" href="#formclass" title="Permanent link">#</a></h3>
<h3 id="backref-none">backref <small>(<code>None</code>)</small><a class="headerlink" href="#backref-none" title="Permanent link">#</a></h3>
<p>If your forms inside the formset have a <code>_model</code> attribute, they will update/create rows in a database when saving the parent form, as expected.</p>
<p>When that&rsquo;s the case, the <code>backref</code> attribute is something you might need to add.</p>
<h4 id="without-backref">Without backref<a class="headerlink" href="#without-backref" title="Permanent link">#</a></h4>
<p><img alt="Without backref" src="../img/without-backref.png" /></p>
<p><strong>Without</strong> a <code>backref</code> attribute, Proper Form will try to save the child forms first, and them assign the list of them to the parent form. If you are dealing with models instead of dictionaries, your database might not like that.</p>
<p>In the example above, a WebPage model will have a non-nullable <code>person_id</code> field. If we save those forms first, you will not have yet a <code>person</code> to get the ID from, so the save operation is going to fail.</p>
<p>We&rsquo;ll need to create a person first, <em>and then</em> create the child objects using the person as an argument.</p>
<h4 id="with-backref">With backref<a class="headerlink" href="#with-backref" title="Permanent link">#</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Possible SQLAlchemy models</span>

<span class="k">class</span> <span class="nc">WebPage</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
  <span class="n">owner_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Integer</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s2">&quot;owner.id&quot;</span><span class="p">))</span>
  <span class="n">owner</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="s2">&quot;Person&quot;</span><span class="p">,</span> <span class="n">back_populates</span><span class="o">=</span><span class="s2">&quot;webs&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span>
</code></pre></div>

<p>A <code>backref</code> is how the child models call its parents, in this example, is &ldquo;owner&rdquo;, so we use that as a backref attribute:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">WebPageForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
  <span class="n">url</span> <span class="o">=</span> <span class="n">URL</span><span class="p">()</span>
  <span class="n">title</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PersonForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
  <span class="n">name</span> <span class="o">=</span> <span class="n">Text</span><span class="p">()</span>
  <span class="n">webs</span> <span class="o">=</span> <span class="n">FormSet</span><span class="p">(</span><span class="n">WebPageForm</span><span class="p">,</span> <span class="n">backref</span><span class="o">=</span><span class="s2">&quot;owner&quot;</span><span class="p">)</span>
</code></pre></div>

<p>When Proper Form receives a <code>backref</code>, it reverse the order of the form saving. Now first it creates the parent object, and then the child objects using the parent object as an attribute.</p>
<p><img alt="With backref" src="../img/with-backref.png" /></p>
<p>In this way, no database constraints are broken and the saving of the form finish without problems.</p>
<h3 id="extra-1">extra <small>(<code>1</code>)</small><a class="headerlink" href="#extra-1" title="Permanent link">#</a></h3>
<p>Number of extra empty forms added to the list, even if there is no data available.</p>
<h3 id="min_num-none">min_num <small>(<code>None</code>)</small><a class="headerlink" href="#min_num-none" title="Permanent link">#</a></h3>
<p>Validates that the number of sub-forms, existing plus new, is <em>at least</em> this.</p>
<h3 id="max_num-none">max_num <small>(<code>None</code>)</small><a class="headerlink" href="#max_num-none" title="Permanent link">#</a></h3>
<p>Validates that the number of sub-forms, existing plus new, is <em>at most</em> this.</p>
<h3 id="can_delete-true">can_delete <small>(<code>True</code>)</small><a class="headerlink" href="#can_delete-true" title="Permanent link">#</a></h3>
<p>If this option is <code>False</code>, <a href="#deleting-existing-forms">the special name</a> to delete a form is ignored and no objects are deleted.</p>
<h3 id="can_create-true">can_create <small>(<code>True</code>)</small><a class="headerlink" href="#can_create-true" title="Permanent link">#</a></h3>
<p>If this option is <code>False</code>, <a href="#using-input-data-with-a-formset">the data from all new forms</a> is ignored. You can only use the formset to edit the data of pre-existing objects.</p>
<h3 id="error_messages-none">error_messages <small>(<code>None</code>)</small><a class="headerlink" href="#error_messages-none" title="Permanent link">#</a></h3>
<p>The <code>min_num</code>, and <code>max_num</code> validations fail with this predefined error messages:</p>
<div class="highlight"><pre><span></span><code><span class="n">default_error_messages</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;min_num&quot;</span><span class="p">:</span> <span class="s2">&quot;Please submit at least </span><span class="si">{num}</span><span class="s2"> forms.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_num&quot;</span><span class="p">:</span> <span class="s2">&quot;Please submit at most </span><span class="si">{num}</span><span class="s2"> forms.&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>

<p>The <code>error_messages</code> argument allows you to overwrite all or one of these messages by passing a dictionary with your custom error messages for those validations.</p>
<h2 id="adding-new-forms-with-javascript">Adding new forms with JavaScript<a class="headerlink" href="#adding-new-forms-with-javascript" title="Permanent link">#</a></h2>
<p>[ TODO ]</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../validators/" title="Validators" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Validators
              </div>
            </div>
          </a>
        
        
          <a href="../orm/" title="ORM integration" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                ORM integration
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/jpsca/proper-form" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../assets/javascripts/bundle.4a5ba8d6.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ["instant"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.9b3611bd.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>